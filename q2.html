<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le voyage de Celia</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            background-image: url('images/q1-1.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #ffffff;
            position: relative;
        }
    </style>
</head>

<body>
    <div class="overlay">
        <p id="text">
            Félicitations, tu as trouvé la pierre de Jaspe! N'étant pas une demi-déesse, la porter ne te confèrera pas
            la force d'Hercule, mais elle aura un effet bénéfique sur toi. Fais en bon usage. Bien, la guilde nous a
            envoyé notre prochaine mission.
        </p>
    </div>
    <div>
        <button class="previous-page-button" onclick="goToPreviousPage()">←</button>
        <button id="next" class="next-page-button" onclick="goToNextPage()">→</button>

        <audio id="myaudio" src="music/q1.mp3" autoplay>
            Votre navigateur ne supporte pas l'élément <code>audio</code>.
        </audio>
    </div>
    <script>
        var audio = document.getElementById("myaudio");
        audio.volume = 0.1;

        const text_array = [
            "Félicitations, tu as trouvé la pierre de Jaspe! N'étant pas une demi-déesse, la porter ne te confèrera pas la force d'Hercule, mais elle aura un effet bénéfique sur toi. Fais en bon usage. Bien, la guilde à une autre piste que nous devons explorer.",

            "En des temps immémoriaux, il était un roi d'Athènes connut pour sa grande sagesse et raison. Il s'agissait du célèbre Thésée, fils de Poséidon. Selon la légende, Thésée se rendit dans le labyrinthe, un dédale inextricable de passages tortueux, pour exterminer une créature mi-homme, mi-bête qui y était enfermée. Mais pour Thésée, ce n'était pas seulement un défi physique. Entrer dans ce labyrinthe, c'était aussi plonger dans les méandres de son propre être, affronter ses propres peurs et désirs les plus sombres. Il n'aurait pu en réchapper qu'en s'accrochant au fil de la raison.",

            "Nous pensons que Poséidon et Héphaïstos aurait pu confier la pierre de Lapis-Lazuli au gardien du labyrinthe, dans l'espoir que seul un valeureux héros puisse s'en emparer. Après avoir été vaincu par Thésée, le gardien lui aurait cédé la pierre et quitté son antre pour prendre sa retraite à Toulouse. Rendons-lui une petite visite, il pourra peut-être nous en apprendre plus.",

            "Bien joué! Allons voir un match, la guilde nous a envoyé nos billets. Avec les dernières informations que tu as découvert, ils ont également retrouvé la trace du dernier posseseur de la pierre! Il s'agirait d'un joueur du stade Toulousain, un certain Alfred, mort pour la france pendant la première guerre mondiale. Une fois sur place, il nous faudra trouver son nom.",

            "Bravo, tu as trouvé le dernier détenteur connu de la pierre de Jaspe. Mort sur le champ de bataille, il griffona ses dernièrs mots pour ses camarades, qui ne saisirent jamais leur sens: <em>'Pour trouver la force dans sa main, il faut être à la Place d'Heraklès.'</em>"];

        var page_number = 0;

        // Ajoute une petite pause avant d'ajouter la classe
        setTimeout(function () {
            var overlay = document.querySelector('.overlay');
            overlay.style.opacity = 1;
        }, 100); // 100 millisecondes de délai

        // Fonction pour aller à la page suivante (à personnaliser)
        function goToNextPage() {
            if (page_number == text_array.length - 1) {
                window.location.href = 'index.html';
                return;
            }

            document.getElementById('text').innerHTML = text_array[page_number + 1];
            document.body.style.backgroundImage = `url('images/q2-${page_number + 2}.jpg')`;
            page_number = page_number + 1;

            function callBack(position) {
                // Coordonnées de l'autre position
                const otherLatitude = 43.572903; // Remplacez par la latitude de l'autre position
                const otherLongitude = 1.478029; // Remplacez par la longitude de l'autre position

                // Fonction pour calculer la distance entre deux points en utilisant la formule de Haversine
                function haversine(lat1, lon1, lat2, lon2) {
                    const R = 6371; // Rayon de la Terre en kilomètres
                    const dLat = (lat2 - lat1) * Math.PI / 180;
                    const dLon = (lon2 - lon1) * Math.PI / 180;
                    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                        Math.sin(dLon / 2) * Math.sin(dLon / 2);
                    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
                    const d = R * c;
                    return d;
                }

                // Position actuelle de l'utilisateur
                const userLatitude = position.coords.latitude;
                const userLongitude = position.coords.longitude;

                // Calcul de la distance entre les deux positions
                const distance = haversine(userLatitude, userLongitude, otherLatitude, otherLongitude);

                console.log("Distance: " + distance.toFixed(2) + " km");

                if (distance.toFixed(2) < 4) {
                    document.getElementById("next").hidden = false;
                }
            }

            if (page_number == 2) {
                document.getElementById("next").hidden = true;
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(callBack);
                } else {
                    console.log("Geolocation is not supported by this browser.");
                }
            }
        }

        function goToPreviousPage() {
            if (page_number == 0) {
                window.location.href = 'quetes.html';
            }

            document.getElementById('text').innerHTML = text_array[page_number - 1];
            document.body.style.backgroundImage = `url('images/q2-${page_number}.jpg')`;
            page_number = page_number - 1;
        }

        function fullScreen() {
            if (document.fullscreenEnabled) {
                // Request full-screen mode for the document element
                document.documentElement.requestFullscreen()
                    .then(() => {
                        console.log('Entered fullscreen mode');
                    })
                    .catch((error) => {
                        console.error('Error entering fullscreen mode:', error);
                    });
            } else {
                console.error('Fullscreen mode is not supported in this browser');
            }
        }
    </script>
</body>

</html>